!function($,e,t,n){"use strict";$(t).ready(function(){function e(){return D.isDST?(O="EST",console.log("We are currently on EST")):(O="EDT",console.log("We are currently on EDT")),O}function t(){$.getJSON("./results.json",function(e){var t="";$.each(e.info,function(e,n){t+="<p>"+n.startDate+" ",t+=n.startTime+" ",t+=n.message+"</p>"}),$("#currentMessage").hide().html(t).fadeIn(300)})}function n(){var e=$("#msgForm"),t=e.valid();if(console.log("Form is valid? "+t),t){var n=$("input[name=empId]").val(),i={};z?i.dateWarn="true":i.dateWarn="false",i.msgId=n,i.info=$(".form-duplicate-this").serializeObject(),$.each(i.info,function(e,t){t.startTime+=" "+O,""!==t.endTime&&(t.endTime+=" "+O)}),console.log(i);var r=JSON.stringify(i);console.log(r);var s=moment().unix();console.log("Right now is: "+s),console.log("Readable EST Timestamp: "+b(s)),$.ajax({url:"endpoint.php",data:{data:r},dataType:"json",type:"POST"}).done(function(e){console.log("success"),y(),a(),$(".half.two").append('<div class="good"><p>Your message has been sent!</p></div>'),o($(".good"))}).fail(function(e){console.error("fail")}).always(function(e){console.log("done")})}}function a(){setTimeout(function(){t(),Y()},2e3)}function o(e){setTimeout(function(){e&&e.fadeOut(2e3)},3e3),i(e)}function i(e){e.click(function(){$(this).stop().fadeOut(200)})}function r(){var e=!1,t=$("textarea");$.each(t,function(t,n){n.value.length<=0&&(e=!0)}),e?(c(),f(),k=!1):(s(),d(),k=!0)}function s(){l($(".add-more-messages"))}function c(){p($(".add-more-messages"))}function u(){l($(".remove-last-message"))}function m(){p($(".remove-last-message"))}function d(){l($("#submit"))}function f(){p($("#submit"))}function l(e){e.removeClass("disabled")}function p(e){e.hasClass("disabled")||e.addClass("disabled")}function g(){if(k){var e=$(S),t=0;e.first().off().clone().appendTo(e.parent()),t=$("textarea").length,$.each($(S),function(e,n){if(e==t-1){var a=$(n).find("textarea");a.val("").attr("placeholder","e.g. All Enterprise Systems and applications are operational."),a.on("input",r)}}),c(),k=!1,u()}}function v(){var e=$(S).length,t=$(S+":last");if(e>1)return t.remove(),e--,void(e<=1&&(m(),r()))}function h(e){var t=$(e.target),n=t.val(),a=$("#submit"),o=$(".form-button");5==n.length?(k=!0,a.prop("disabled",!1)):(k=!1,a.prop("disabled",!0))}function T(e){}function b(e){return moment.unix(e).tz("America/New_York").format("MM/DD HH:mm z")}function Y(){$.getJSON("./log.json",function(e){var t=[],n="";$.each(e,function(e,n){var a=n.msgId;$.each(n.info,function(e,n){n.empId=a,t.push(n)})}),$.each(t,function(e,t){n+="<tr>",n+="<td>"+t.empId+"</td>",n+="<td>"+t.startDate+"</td>",n+="<td>"+t.startTime+"</td>",n+="<td>"+t.endDate+"</td>",n+="<td>"+t.endTime+"</td>",n+="<td>"+t.message+"</td>",n+="</tr>"}),$("#return-table tbody").hide().html(n).fadeIn(300)})}function y(){$("input").val(""),$("textarea").val(""),$(S).each(function(e){v()})}$.ajaxSetup({cache:!1});var S=".form-duplicate-this",k=!1,w=$("form#msgForm");w.validate({rules:{empId:{required:!0,digits:!0}}}),$(".dtpicker").datepicker(),$(".add-more-messages").on("click",g),$(".remove-last-message").on("click",v),$("#submit").click(n),$("textarea[name=message]").on("input",r);var x=moment();console.log("EST: "+x.tz("America/New_York").format());var D=moment.tz(x,"America/New_York").format("HH:mm"),j=moment.tz(x,"America/New_York").format("M/D/YYYY"),I=moment().add(1,"days"),N=moment.tz(I,"America/New_York").format("M/D/YYYY"),O;e();var z,E;$.getJSON("dates.json",function(e){$.each(e.regular,function(e,t){if(N===t)return z=!0}),$.each(e.early,function(e,t){if(j===t)return E=!0})}),setTimeout(function(){a()},2e3),$.fn.serializeObject=function(){var e=[];return $(this).each(function(t,n){var a={};$.each($(n).find("input"),function(e,t){var n=$(t).attr("name"),o=$(t).val();a[n]=o}),$.each($(n).find("textarea"),function(e,t){var n=$(t).attr("name"),o=$(t).val();a[n]=o}),e.push(a)}),e},$("input[name=empId]").on("input",function(e){h(e)})})}(jQuery,window,document);