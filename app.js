!function($,e,n,t){"use strict";$(n).ready(function(){function e(){console.log("ajax call to get json for log..."),$.getJSON("log.json",function(e){console.log("call success");var n=e.length;$.each(e,function(e,t){this.startTime+=" "+z,this.endTime+=" "+z,e>=n-5&&a(t)})}).done(function(){console.log("call and loop success")}).fail(function(){console.error("error")}).always(function(){console.log("complete")})}function n(){return S.isDST?(z="EST",console.log("We are currently on EST")):(z="EDT",console.log("We are currently on EDT")),z}function o(){var e=$("#msgForm"),n=e.valid();if(console.log("Form is valid? "+n),n){var t=$("#msgForm").serializeObject();console.log(t);var o=JSON.stringify(t),r=moment().unix();console.log("Right now is: "+r),console.log("Readable EST Timestamp: "+h(r)),$.ajax({url:"endpoint.php",data:{data:o},dataType:"json",type:"POST"}).done(function(e){console.log("success"),a(e.json)}).fail(function(e){console.log("fail")}).always(function(e){console.log("done")})}}function a(e){var n=$("#return-table");if(n.length>0){console.log("updating table...");var t=n.find("tbody"),o=T(e);t.append(o)}}function r(){var e=!1,n=$("textarea");$.each(n,function(n,t){t.value.length<=0&&(e=!0)}),e?(i(),b=!1):(s(),b=!0)}function s(){m($("span.add-more-messages").parent())}function i(){u($("span.add-more-messages").parent())}function l(){m($("span.remove-last-message").parent())}function c(){u($("span.remove-last-message").parent())}function m(e){e.removeClass("disabled")}function u(e){e.hasClass("disabled")||e.addClass("disabled")}function f(){if(b){var e=$(v),n=0;e.first().off().clone().appendTo(e.parent()),n=$("textarea").length,$.each($(v),function(e,t){if(e==n-1){var o=$(t).find("textarea");o.val("").attr("placeholder","e.g. All Enterprise Systems and applications are operational."),o.on("input",r)}}),i(),b=!1,l()}}function d(){var e=$(v).length,n=$(v+":last");if(e>1)return n.remove(),e--,void(e<=1&&(c(),r()))}function g(e){var n=$(e.target),t=n.val(),o=$("#submit"),a=$(".form-button");5==t.length?(b=!0,o.prop("disabled",!1)):(b=!1,o.prop("disabled",!0))}function p(e){}function h(e){return moment.unix(e).tz("America/New_York").format("MM/DD HH:mm z")}var v=".form-duplicate-this",b=!1,y=$("#entry-template").html(),T=Handlebars.compile(y),Y=$("form#msgForm");Y.validate({rules:{empId:{required:!0,digits:!0}}}),$(".dtpicker").datepicker(),$(".add-more-messages").on("click",f),$(".remove-last-message").on("click",d),$("#submit").on("click",o),$("textarea[name=message]").on("input",r),e();var j=moment();console.log("EST: "+j.tz("America/New_York").format());var S=moment.tz(j,"America/New_York").format(),k=moment.tz(j,"America/New_York").format("M/D/YYYY"),w=moment().add(1,"days"),x=moment.tz(w,"America/New_York").format("M/D/YYYY"),z;n();var D,N;$.getJSON("dates.json",function(e){$.each(e.regular,function(e,n){if(x===n)return D=!0}),$.each(e.early,function(e,n){if(k===n)return N=!0})}),$.ajaxSetup({cache:!1}),setTimeout(function(){$.get("./results.json",function(e){for(var n="",t=0;t<e.startDate.length;t++)n+="<p>"+e.startDate[t]+" "+e.startTime[t]+" "+e.message[t]+"</p>";$("#currentMessage").html(n)})},2e3),$.fn.serializeObject=function(){var e={},n=this.serializeArray();return $.each(n,function(){e[this.name]!==t?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$("input[name=empId]").on("input",function(e){g(e)})})}(jQuery,window,document);